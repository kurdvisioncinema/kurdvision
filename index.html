<!DOCTYPE html>
<html lang="ku" dir="rtl">
<head>
<meta charset="UTF-8">
<title>KurdVision â€“ Clean Version</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@400;600;700&display=swap" rel="stylesheet">
<style>
body{
    margin:0;
    font-family:'IBM Plex Sans Arabic',sans-serif;
    background:#0f0f1e;
    color:#fff;
}
header{
    padding:15px 20px;
    background:#1a1a2e;
    display:flex;
    justify-content:space-between;
    align-items:center;
}
button{
    background:#e94560;
    border:none;
    padding:10px 16px;
    border-radius:6px;
    color:#fff;
    cursor:pointer;
}
.grid{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(180px,1fr));
    gap:20px;
    padding:20px;
}
.card{
    background:#16213e;
    border-radius:10px;
    overflow:hidden;
    cursor:pointer;
}
.card img{
    width:100%;
    aspect-ratio:2/3;
    object-fit:cover;
}
.card h3{
    font-size:14px;
    padding:10px;
}
#detail{
    display:none;
    padding:20px;
}
iframe{
    width:100%;
    height:360px;
    border:none;
    border-radius:10px;
}
</style>
</head>
<body>

<header>
    <h2>ðŸŽ¬ KurdVision</h2>
    <button onclick="login()">Ú†ÙˆÙˆÙ†Û•Ú˜ÙˆÙˆØ±Û•ÙˆÛ•</button>
</header>

<div id="home">
    <div class="grid" id="movies"></div>
</div>

<div id="detail">
    <button onclick="back()">â¬… Ú¯Û•Ú•Ø§Ù†Û•ÙˆÛ•</button>
    <h1 id="dTitle"></h1>
    <iframe id="player"></iframe>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";
import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

const firebaseConfig = {
 apiKey: "AIzaSyAaE1v9PcHGsSgF1IlnDrygX5TT2-zii8o",
 authDomain: "kurdvision-f9d3e.firebaseapp.com",
 databaseURL: "https://kurdvision-f9d3e-default-rtdb.europe-west1.firebasedatabase.app",
 projectId: "kurdvision-f9d3e"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const auth = getAuth(app);

let content = [];

onValue(ref(db,"content"),snap=>{
    content=[];
    snap.forEach(c=>{
        content.push({id:c.key,...c.val()});
    });
    render();
});

function render(){
    const grid=document.getElementById("movies");
    grid.innerHTML="";
    content.forEach(item=>{
        grid.innerHTML+=`
        <div class="card" onclick="openDetail('${item.id}')">
            <img src="${item.poster}">
            <h3>${item.title}</h3>
        </div>`;
    });
}

window.openDetail=id=>{
    const item=content.find(x=>x.id===id);
    document.getElementById("home").style.display="none";
    document.getElementById("detail").style.display="block";
    document.getElementById("dTitle").innerText=item.title;
    document.getElementById("player").src=item.servers.server1;
};

window.back=()=>{
    document.getElementById("detail").style.display="none";
    document.getElementById("home").style.display="block";
};

window.login=()=>{
    signInAnonymously(auth).then(()=>{
        alert("Ú†ÙˆÙˆÙ†Û•Ú˜ÙˆÙˆØ±Û•ÙˆÛ• Ø³Û•Ø±Ú©Û•ÙˆØªÙˆÙˆ Ø¨ÙˆÙˆ");
    });
};
</script>
</body>
</html>
